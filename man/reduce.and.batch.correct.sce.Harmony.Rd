% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/reduction.R
\name{reduce.and.batch.correct.sce.Harmony}
\alias{reduce.and.batch.correct.sce.Harmony}
\title{Takes a `SingleCellExperiment` object, batch corrects, and adds the reduced kernel matrix
(It used Harmony for batch-correction: https://github.com/immunogenomics/harmony)}
\usage{
reduce.and.batch.correct.sce.Harmony(sce, batch.vec = NULL,
  reduced_dim = 50, max.iter = 5, data.slot = "logcounts",
  normalization.method = "default")
}
\arguments{
\item{sce}{Input sce object}

\item{batch.vec}{Vector of batches per sample}

\item{reduced_dim}{Dimension of SVD used for reducing kernel matrix}

\item{max.iter}{Number of SVD iterations}

\item{norm.method}{Normalization method to use. See normalize.sce() function (default:"default")
(used only if the sce object is not already normalized)}

\item{passphrase}{Passphrase for encrypting column names of the sce object for anonymization}
}
\value{
Reduced sce object with added ReducedDims(sce)[["S_r"]]
}
\description{
Takes a `SingleCellExperiment` object, batch corrects, and adds the reduced kernel matrix
(It used Harmony for batch-correction: https://github.com/immunogenomics/harmony)
}
\examples{
sce = import.sce.from.10X(input_path)
batch.vec = sce$Batch # Assumes sample annotations are in the input_path with "Batch" attribute being provided
sce = reduce.and.batch.correct.sce.Harmony(sce)
}
